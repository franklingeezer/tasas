<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Smart Attendance Analytics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- DaisyUI + Tailwind -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<!-- ================= NAVBAR ================= -->
<nav class="fixed top-0 left-0 w-full z-50">
  <div class="max-w-7xl mx-auto px-6 py-4">
    <div class="flex items-center justify-between
                bg-white/10 backdrop-blur-xl
                border border-white/20
                rounded-2xl
                px-8 py-3
                shadow-[0_8px_30px_rgba(0,0,0,0.3)]">

      <!-- Logo -->
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-xl
                    bg-gradient-to-tr from-indigo-500 to-purple-600
                    flex items-center justify-center
                    text-white font-bold text-lg shadow-lg">
          T
        </div>
        <span class="text-white text-xl font-semibold tracking-wide">
          TASAS
        </span>
      </div>

      <!-- Links -->
      <div class="hidden md:flex items-center gap-8 text-white/80 text-sm font-medium">
        <button onclick="showSection('dashboard', this)"
          class="nav-link text-white transition">
          Dashboard
        </button>

        <button onclick="showSection('analytics', this)"
          class="nav-link text-white/70 transition hover:text-white">
          Analytics
        </button>
      </div>

      <!-- Logout -->
      <button id="logoutBtn"
        class="px-6 py-3 rounded-lg
               bg-gradient-to-r from-indigo-500 to-purple-600
               text-white text-lg font-medium
               shadow-lg hover:scale-105
               transition duration-300">
        Logout
      </button>

    </div>
  </div>
</nav>

<!-- ================= MAIN CONTAINER ================= -->
<div class="container relative pt-32">

  <h1 class="text-[35px] font-semibold mb-8 text-white 
           flex items-center justify-center gap-3 tracking-wide">
    Smart Attendance Analytics
  </h1>

  <!-- ================= DASHBOARD SECTION ================= -->
  <div id="dashboardSection">

    <!-- Stats -->
    <div class="stats mb-8">
      <div class="card">Students<br><span id="totalCount">0</span></div>
      <div class="card">Avg Attendance<br><span id="percentage">0%</span></div>
      <div class="card danger">Low Attendance<br><span id="lowAttendance">0</span></div>
    </div>

    <!-- Chart -->
    <div class="chart-glass-container">
      <h2 class="text-white text-lg mb-4">ðŸ“˜ Subject-wise Attendance (%)</h2>
      <div class="chart-container h-[350px]">
        <canvas id="subjectChart"></canvas>
      </div>
    </div>

    <!-- ================= RECENT ACTIVITY ================= -->
<div class="mt-8 bg-white/5 backdrop-blur-xl border border-white/10
            rounded-2xl p-6 shadow-lg">

  <div class="flex items-center justify-between mb-6">
    <h2 class="text-white text-lg font-semibold">
      ðŸ•’ Recent Activity
    </h2>
    <span class="text-sm text-white/50">
      Live updates
    </span>
  </div>

  <div id="recentActivityList" class="space-y-4 max-h-[300px] overflow-y-auto">

    <!-- Activity items will appear here dynamically -->

  </div>

</div>

  </div>

  <!-- ================= ANALYTICS SECTION ================= -->
  <div id="analyticsSection" class="hidden">

    <div class="table-glass-container">

  <div class="flex justify-between items-center mb-6">
    <h2 class="text-white text-lg font-semibold">
      ðŸ“‹ Student Attendance (Course-wise)
    </h2>

    <!-- Search Input -->
    <input
      type="text"
      id="searchInput"
      placeholder="Search by ID or Name..."
      class="px-4 py-2 rounded-lg bg-white/10 border border-white/20
             text-white placeholder-white/50 text-sm
             focus:outline-none focus:ring-2 focus:ring-indigo-500
             transition-all duration-300 w-64"
    />
  </div>

  <table id="attendanceTable">
    <thead>
      <tr>
        <th class="sortable">Student ID</th>
        <th>Name</th>
        <th>Course</th>
        <th>Total</th>
        <th>Present</th>
        <th>%</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

</div>

  </div>

</div>

<!-- Toast -->
<div id="toastContainer" class="fixed top-6 right-6 space-y-4 z-50"></div>

<!-- Firebase Scripts -->
<script type="module" src="firebaseConfig.js"></script>
<script type="module" src="app.js"></script>

<!-- Section Switch Script -->
<script>
  function showSection(section, el) {
    const dashboard = document.getElementById("dashboardSection");
    const analytics = document.getElementById("analyticsSection");

    dashboard.classList.add("hidden");
    analytics.classList.add("hidden");

    if (section === "dashboard") {
      dashboard.classList.remove("hidden");
    }

    if (section === "analytics") {
      analytics.classList.remove("hidden");
    }

    // Active link styling
    document.querySelectorAll(".nav-link").forEach(link => {
      link.classList.remove("text-white");
      link.classList.add("text-white/70");
    });

    el.classList.remove("text-white/70");
    el.classList.add("text-white");
  }
</script>

</body>
</html>